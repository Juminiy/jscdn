const btn=document.querySelector('.start')const find_btn=document.querySelector('#find_start')const boy_number_input=document.querySelector('#boy_number');const girl_number_input=document.querySelector('#girl_number');const boy_number_find_input=document.querySelector('#boy_number_find');const girl_number_find_input=document.querySelector('#girl_number_find')const song_number_input=document.querySelector('#song_number');const showlist=document.querySelector('#showlist')const result=document.querySelector('#Result')var song_store=[];const mycanvas=document.querySelector('#mycanvas')const ctx=mycanvas.getContext('2d');var boy_number=0;var girl_number=0;var song_number=0;var boy_number_find=0;var girl_number_find=0;btn.addEventListener('click',(e)=>{e.preventDefault();boy_number=boy_number_input.value;girl_number=girl_number_input.value;song_number=song_number_input.value;let myarr=startDance(boy_number,girl_number,song_number);let boy_arr=myarr.first;let girl_arr=myarr.second;let second_boy_arr=myarr.third;animation(boy_arr);animation2(girl_arr);animation3(second_boy_arr)});find_btn.addEventListener('click',(e)=>{e.preventDefault();boy_number_find=boy_number_find_input.value;girl_number_find=girl_number_find_input.value;console.log(song_store)const flag=0;for(let i=0;i<song_store.length;i++){if(song_store[i].song_match[0]==boy_number_find&&song_store[i].song_match[1]==girl_number_find){const li=document.createElement('li');li.style.color="lightcyan"li.style.listStyle="none"li.style.fontSize="xx-small"li.style.margin="5px"li.style.borderRadius="3px"li.style.background=":rgba(0,0,50,0.8)"const text=`第${boy_number_find}号男生和第${girl_number_find}号女生在第${song_store[i].number}首歌相遇`li.appendChild(document.createTextNode(text));result.appendChild(li);flag=1}}if(flag==0){const li=document.createElement('li');li.style.color="lightcyan"li.style.listStyle="none"li.style.fontSize="xx-small"li.style.margin="5px"li.style.borderRadius="3px"li.style.background=":rgba(0,0,50,0.8)"const text=`第${boy_number_find}号男生和第${girl_number_find}号女生没有相遇`li.appendChild(document.createTextNode(text));result.appendChild(li)}})function startDance(boy_number,girl_number,song_number){console.log(boy_number,girl_number,song_number)var boys=[];var boys2=[];var girls=[];var songs=[];for(let i=1;i<=boy_number;i++){boys.push({number:i})}var virtualArr=[{first:boys.concat(boys2),second:'start',third:-1}];for(let i=1;i<=girl_number;i++){girls.push({number:i})}var girl_virtualArr=[{first:girls.slice(),second:'start'}]var second_boy_virtualArr=[{first:boys2.slice(),second:'end'}]for(let i=1;i<=song_number;i++){songs.push({number:i,song_match:[]})}for(let i=1;i<=song_number;++i){virtualArr.push({first:boys.slice(),second:'start',third:-1});girl_virtualArr.push({first:girls.slice(),second:'start'})second_boy_virtualArr.push({first:boys2.slice(),second:"end"})while(Math.round(Math.random())==0){if(boys.length==0){boys.push.apply(boys,boys2);boys2=[]}second_boy_virtualArr.push({first:boys2.slice(),second:"end"})virtualArr.push({first:boys.slice(),second:'start_match_fail',third:-1});girl_virtualArr.push({first:girls.slice(),second:'start_match_fail'})boys2.push(boys.shift());second_boy_virtualArr.push({first:boys2.slice(),second:"end"})virtualArr.push({first:boys.slice(),second:'start',third:-1});girl_virtualArr.push({first:girls.slice(),second:'start'})}if(boys.length==0){boys.push.apply(boys,boys2);boys2=[]}virtualArr.push({first:boys.slice(),second:'start_match_success',third:-1});girl_virtualArr.push({first:girls.slice(),second:'start_match_success'})second_boy_virtualArr.push({first:boys2.slice(),second:"end"})songs[i-1].song_match.push(boys[0].number);songs[i-1].song_match.push(girls[0].number);const li=document.createElement('li');li.style.color="lightcyan"li.style.listStyle="none"li.style.fontSize="xx-small"li.style.margin="5px"li.style.borderRadius="3px"li.style.background=":rgba(0,0,50,0.8)"const text=`第${i}首歌匹配到了${boys[0].number}号男生和${girls[0].number}号女生`li.appendChild(document.createTextNode(text));showlist.appendChild(li);boys.push(boys.shift());virtualArr.push({first:boys.slice(),second:'end',third:-1});girls.push(girls.shift());girl_virtualArr.push({first:girls.slice(),second:'end'})second_boy_virtualArr.push({first:boys2.slice(),second:"end"})}song_store=songs.slice();let MY_virtualArr={first:virtualArr,second:girl_virtualArr,third:second_boy_virtualArr}console.log(second_boy_virtualArr);return MY_virtualArr}function draw(arr){const width=25;var space=10;ctx.clearRect(0,0,mycanvas.width,99);ctx.font="18px serif";ctx.fillText("男孩子队列",width,25)switch(arr.second){case"start":for(let i=0;i<arr.first.length;i++){if(i==0){ctx.fillStyle='gray'}else{ctx.fillStyle='#61C5FE'}ctx.fillRect(i*(width+space),50,width,width);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),75)}break;case"start_match_fail":for(let i=0;i<arr.first.length;i++){if(i==0){ctx.fillStyle='red'}else{ctx.fillStyle='#61C5FE'}ctx.fillRect(i*(width+space),50,width,width);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),75)}break;case"start_match_success":for(let i=0;i<arr.first.length;i++){if(i==0){ctx.fillStyle='green'}else{ctx.fillStyle='#61C5FE'}ctx.fillRect(i*(width+space),50,width,width);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),75)}break;case"end":for(let i=0;i<arr.first.length;i++){if(i==arr.first.length-1){ctx.fillStyle='green'}else{ctx.fillStyle='#61C5FE'}ctx.fillRect(i*(width+space),50,width,width);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),75)}break}}function animation(arr){var virtualArr=arr;var interval=700;virtualArr.forEach((item,index)=>{setTimeout(()=>draw(item),index*interval)})}function draw2(arr){const width=25;var space=10;ctx.clearRect(0,99,mycanvas.width,125);ctx.moveTo(0,100);ctx.lineTo(mycanvas.width,100);ctx.moveTo(0,125);ctx.lineTo(mycanvas.width,125);ctx.stroke();ctx.font="18px serif";ctx.fillText("女孩子队列",25,150)switch(arr.second){case"start":for(let i=0;i<arr.first.length;i++){if(i==0){ctx.fillStyle='gray'ctx.fillText("歌曲开始,匹配中",i*(width+space),175)}else{ctx.fillStyle='#61C5FE'}ctx.fillRect(i*(width+space),100,width,25);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),125)}break;case"start_match_fail":for(let i=0;i<arr.first.length;i++){if(i==0){ctx.fillStyle='red'ctx.fillText("歌曲结束,匹配失败",i*(width+space),175)}else{ctx.fillStyle='#61C5FE'}ctx.fillRect(i*(width+space),100,width,25);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),125)}break;case"start_match_success":for(let i=0;i<arr.first.length;i++){if(i==0){ctx.fillStyle='green'ctx.fillText("歌曲结束,匹配成功",i*(width+space),175)}else{ctx.fillStyle='#61C5FE'}ctx.fillRect(i*(width+space),100,width,25);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),125)}break;case"end":for(let i=0;i<arr.first.length;i++){if(i==arr.first.length-1){ctx.fillStyle='green'}else{ctx.fillStyle='#61C5FE'}ctx.fillRect(i*(width+space),100,width,25);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),125)}break}}function animation2(arr){var virtualArr=arr;var interval=700;virtualArr.forEach((item,index)=>{setTimeout(()=>draw2(item),index*interval)})}function draw3(arr){const width=25;var space=10;ctx.clearRect(0,185,mycanvas.width,300);if(arr.first.length==0){ctx.fillText("男孩子第二队列为空",(width+space),275)}else{ctx.fillText("男孩子第二队列不为空",(width+space),275)}switch(arr.second){case"end":for(let i=0;i<arr.first.length;i++){ctx.fillStyle='#61C5FE';ctx.fillRect(i*(width+space),225,width,25);ctx.fillStyle='#240be4';ctx.fillText(arr.first[i].number,i*(width+space),250)}break}}function animation2(arr){var virtualArr=arr;var interval=700;virtualArr.forEach((item,index)=>{setTimeout(()=>draw2(item),index*interval)})}function animation3(arr){var virtualArr=arr;var interval=700;virtualArr.forEach((item,index)=>{setTimeout(()=>draw3(item),index*interval)})}